<!DOCTYPE html> 
<html lang="en"> 
  <head> 
    <meta charset="UTF-8" /> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /> 
    <title>MindAR Example</title> 
    <link rel="stylesheet" href="styles.css" /> 
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script> 
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script> 

    <style> 
      body { 
        margin: 0; 
        overflow: hidden; /* ป้องกันการเลื่อน */ 
      } 
      #ar-container { 
        position: absolute; 
        top: 0; 
        left: 0; 
        width: 100%; 
        height: 100%; 
        z-index: 1; /* ให้แสดงอยู่ด้านบน */ 
      } 
      .exit-button { 
        position: absolute; 
        top: 20px; 
        right: 20px; 
        background-color: #ff4c4c; 
        color: white; 
        padding: 10px; 
        border: none; 
        border-radius: 5px; 
        cursor: pointer; 
        z-index: 5; /* ทำให้ปุ่มอยู่ด้านบนสุด */ 
      } 
      .exit-button:hover { 
        background-color: #ff1c1c; 
      } 
    </style> 
  </head> 
  <body> 
    <button class="exit-button" onclick="exitScanner()">ออกจากการสแกน</button> 
    <div id="ar-container"> 
      <a-scene mindar-image="imageTargetSrc: ./markers/targets1.mind;" embedded> 
        <!-- กล้อง --> 
        <a-camera></a-camera> 

        <!-- โมเดล 3D ที่จะปรากฏเมื่อสแกนภาพ --> 
        <a-entity mindar-image-target="targetIndex: 0" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="model/bkk.glb" scale="0.05 0.05 0.05" position="0 0 0"></a-entity>
        </a-entity>

        <a-entity mindar-image-target="targetIndex: 1" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="model/Bacc_.glb" scale="0.0001 0.0001 0.0001" position="0 0 0"></a-entity>
        </a-entity>

        <a-entity mindar-image-target="targetIndex: 2" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="model/ben_01.glb" scale="0.001 0.001 0.001" position="0 0 0"></a-entity>
        </a-entity>

        <a-entity mindar-image-target="targetIndex: 3" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="model/Sao.glb" scale="0.05 0.05 0.05" position="0 0 0"></a-entity>
        </a-entity>

        <a-entity mindar-image-target="targetIndex: 4" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="model/Phukaothong.glb" scale="0.05 0.05 0.05" position="0 0 0"></a-entity>
        </a-entity>

        <a-entity mindar-image-target="targetIndex: 5" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="model/sanamluang05.glb" scale="0.001 0.001 0.001" position="0 0 0"></a-entity>
        </a-entity>

        <a-entity mindar-image-target="targetIndex: 6" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="model/mueee.glb" scale="0.0001 0.0001 0.0001" position="0 0 0"></a-entity>
        </a-entity>

        <!-- เพิ่มโมเดล ท่ามหาราช --> 
        <a-entity mindar-image-target="targetIndex: 7" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="model/watpha03.glb" scale="0.0001 0.0001 0.0001" position="0 0 0"></a-entity>
        </a-entity>

        <!-- เพิ่มโมเดล วัด --> 
        <a-entity mindar-image-target="targetIndex: 8" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="model/Sapanputhh (2).glb" scale="0.001 0.001 0.001" position="0 0 0"></a-entity>
        </a-entity>

        <!-- เพิ่มโมเดล สวนเบญจกิติ --> 
        <a-entity mindar-image-target="targetIndex: 9" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="model/thamaharat.glb" scale="0.001 0.001 0.001" position="0 0 0"></a-entity>
        </a-entity>
      </a-scene> 
    </div> 

    <a-assets> 
      <a-asset-item id="bkk-planetarium" src="model/bkk.glb"></a-asset-item> 
      <a-asset-item id="BACC" src="model/Bacc_.glb"></a-asset-item> 
      <a-asset-item id="ภูเขาทอง" src="model/Phukaothong.glb"></a-asset-item> 
      <a-asset-item id="มิวเซียมสยามมีสีแล้ว" src="model/mueee.glb"></a-asset-item> 
      <a-asset-item id="เสาชิงช้า" src="model/Sao.glb"></a-asset-item> 
      <a-asset-item id="SanamLuang" src="model/sanamluang05.glb"></a-asset-item> 
      <a-asset-item id="sapanputh" src="model/sapanputhh.glb"></a-asset-item> 
      <a-asset-item id="ThaMaharaj" src="model/thamaharat.glb"></a-asset-item> 
      <a-asset-item id="Temple" src="model/watpha03.glb"></a-asset-item> 
      <a-asset-item id="Benchakitti" src="model/benkit.glb"></a-asset-item> 
    </a-assets> 

    <script> 
      function exitScanner() { 
        const arContainer = document.getElementById("ar-container"); 
        arContainer.style.display = "none"; 
        window.location.assign("index.html"); 
      } 

      window.onload = function () { 
        const arContainer = document.getElementById("ar-container"); 
        arContainer.style.display = "block"; 
        startScanner(); 
      }; 

      function startScanner() { 
        navigator.mediaDevices 
          .getUserMedia({ video: true }) 
          .then((stream) => { 
            const videoElement = document.createElement("video"); 
            videoElement.srcObject = stream; 
            videoElement.autoplay = true; 
            videoElement.style.width = "100%"; 
            videoElement.style.height = "100%"; 
            videoElement.style.position = "absolute"; 
            videoElement.style.top = "0"; 
            videoElement.style.left = "0"; 
            videoElement.style.zIndex = "0"; 
            document.body.appendChild(videoElement); 
          }) 
          .catch((error) => { 
            console.error("Error accessing the camera:", error); 
          }); 
      } 

      // ฟังก์ชันการหมุนโมเดล
      const models = document.querySelectorAll('.model');

      models.forEach(model => {
        let isDragging = false;
        let previousMousePosition = { x: 0, y: 0 };

        model.addEventListener('mousedown', (event) => {
          isDragging = true;
          previousMousePosition = { x: event.clientX, y: event.clientY };
        });

        model.addEventListener('mouseup', () => {
          isDragging = false;
        });

        model.addEventListener('mouseleave', () => {
          isDragging = false;
        });

        model.addEventListener('mousemove', (event) => {
          if (isDragging) {
            const deltaX = event.clientX - previousMousePosition.x;
            const deltaY = event.clientY - previousMousePosition.y;

            const rotation = model.getAttribute('rotation');
            model.setAttribute('rotation', {
              x: rotation.x + deltaY * 0.1,
              y: rotation.y + deltaX * 0.1,
              z: rotation.z
            });

            previousMousePosition = { x: event.clientX, y: event.clientY };
          }
        });
      });
    </script> 
  </body> 
</html>
