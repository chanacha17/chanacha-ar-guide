<!DOCTYPE html> 
<html lang="en"> 
  <head> 
    <meta charset="UTF-8" /> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /> 
    <title>Phetchaburi AR Scanner</title> 
    <link rel="stylesheet" href="styles.css" /> 
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script> 
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script> 

    <style> 
      body { 
        margin: 0; 
        overflow: hidden; /* ป้องกันการเลื่อน */ 
      } 
      #ar-container { 
        position: absolute; 
        top: 0; 
        left: 0; 
        width: 100%; 
        height: 100%; 
        z-index: 1; /* ให้แสดงอยู่ด้านบน */ 
      } 
      .exit-button { 
        position: absolute; 
        top: 20px; 
        right: 20px; 
        background-color: #ff4c4c; 
        color: white; 
        padding: 10px; 
        border: none; 
        border-radius: 5px; 
        cursor: pointer; 
        z-index: 5; /* ทำให้ปุ่มอยู่ด้านบนสุด */ 
      } 
      .exit-button:hover { 
        background-color: #ff1c1c; 
      } 
    </style> 
  </head> 
  <body> 
    <button class="exit-button" onclick="exitScanner()">ออกจากการสแกน</button> 
    <div id="ar-container"> 
      <a-scene mindar-image="imageTargetSrc: markers/targets.mind;" embedded>  
        <!-- กล้อง --> 
        <a-camera></a-camera> 

        <!-- P1: Cha-am Beach --> 
        <a-entity mindar-image-target="targetIndex: 0" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="\model\Cha-am.glb" scale="0.5 0.5 0.5" position="0 0 0"></a-entity>
        </a-entity>

        <!-- P2: Tham Chaeng Temple --> 
        <a-entity mindar-image-target="targetIndex: 1" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="\model\Tham-Chaeng.glb" scale="0.5 0.5 0.5" position="0 0 0"></a-entity>
        </a-entity>

        <!-- P3: The Chang Hua Man Royal Project --> 
        <a-entity mindar-image-target="targetIndex: 2" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="model/Tremendous Robo (1).glb" scale="0.5 0.5 0.5" position="0 0 0"></a-entity>
        </a-entity>

        <!-- P4: Khao Bandai It Temple --> 
        <a-entity mindar-image-target="targetIndex: 3" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="model/Fantabulous Jaban (1).glb" scale="0.5 0.5 0.5" position="0 0 0"></a-entity>
        </a-entity>

        <!-- P5: Phra Nakhon Khiri Historical Park --> 
        <a-entity mindar-image-target="targetIndex: 4" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="model/Spectacular Jaagub.glb" scale="0.5 0.5 0.5" position="0 0 0"></a-entity>
        </a-entity>

        <!-- P6: Khoi Temple --> 
        <a-entity mindar-image-target="targetIndex: 5" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="model/Smooth Borwo-Hillar.glb" scale="0.5 0.5 0.5" position="0 0 0"></a-entity>
        </a-entity>

        <!-- P7: Phra Ram Ratchaniwet --> 
        <a-entity mindar-image-target="targetIndex: 6" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="model/Epic Jaagub-Habbi.glb" scale="0.5 0.5 0.5" position="0 0 0"></a-entity>
        </a-entity>

        <!-- P8: Wat Mahathat Worawihan --> 
        <a-entity mindar-image-target="targetIndex: 7" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="model/Fantastic Jaban-Wolt (1).glb" scale="0.5 0.5 0.5" position="0 0 0"></a-entity>
        </a-entity>

        <!-- P9: Wat Pak Nok Thale --> 
        <a-entity mindar-image-target="targetIndex: 8" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="model/Terrific Curcan.glb" scale="0.5 0.5 0.5" position="0 0 0"></a-entity>
        </a-entity>

        <!-- P10: Khao Yoi Cave Temple --> 
        <a-entity mindar-image-target="targetIndex: 9" class="model" rotation="0 0 0"> 
          <a-entity gltf-model="model/Mighty Borwo (1).glb" scale="0.5 0.5 0.5" position="0 0 0"></a-entity>
        </a-entity>
      </a-scene> 
    </div> 

    <a-assets> 
      <a-asset-item id="cha-am" src="model/Fantabulous Turing.glb"></a-asset-item> 
      <a-asset-item id="tham-chaeng" src="model/Tremendous Robo (1).glb"></a-asset-item> 
      <a-asset-item id="chang-hua-man" src="model/Fantabulous Jaban (1).glb"></a-asset-item> 
      <a-asset-item id="khao-bandai-it" src="model/Spectacular Jaagub.glb"></a-asset-item> 
      <a-asset-item id="phra-nakhon-khiri" src="model/Smooth Borwo-Hillar.glb"></a-asset-item> 
      <a-asset-item id="khoi-temple" src="model/Tremendous Jaagub-Wluff.glb"></a-asset-item> 
      <a-asset-item id="phra-ram-ratchaniwet" src="model/Epic Jaagub-Habbi.glb"></a-asset-item> 
      <a-asset-item id="wat-mahathat" src="model/Fantastic Jaban-Wolt (1).glb"></a-asset-item> 
      <a-asset-item id="wat-pak-nok-thale" src="model/Terrific Curcan.glb"></a-asset-item> 
      <a-asset-item id="khao-yoi-cave" src="model/Mighty Borwo (1).glb"></a-asset-item> 
    </a-assets> 

    <script> 
      function exitScanner() { 
        const arContainer = document.getElementById("ar-container"); 
        arContainer.style.display = "none"; 
        window.location.assign("index.html"); 
      } 

      window.onload = function () { 
        const arContainer = document.getElementById("ar-container"); 
        arContainer.style.display = "block"; 
        startScanner(); 
      }; 

      function startScanner() { 
        navigator.mediaDevices 
          .getUserMedia({ video: true }) 
          .then((stream) => { 
            const videoElement = document.createElement("video"); 
            videoElement.srcObject = stream; 
            videoElement.autoplay = true; 
            videoElement.style.width = "100%"; 
            videoElement.style.height = "100%"; 
            videoElement.style.position = "absolute"; 
            videoElement.style.top = "0"; 
            videoElement.style.left = "0"; 
            videoElement.style.zIndex = "0"; 
            document.body.appendChild(videoElement); 
          }) 
          .catch((error) => { 
            console.error("Error accessing the camera:", error); 
          }); 
      } 

      // ฟังก์ชันการหมุนโมเดล
      const models = document.querySelectorAll('.model');

      models.forEach(model => {
        let isDragging = false;
        let previousMousePosition = { x: 0, y: 0 };

        model.addEventListener('mousedown', (event) => {
          isDragging = true;
          previousMousePosition = { x: event.clientX, y: event.clientY };
        });

        model.addEventListener('mouseup', () => {
          isDragging = false;
        });

        model.addEventListener('mouseleave', () => {
          isDragging = false;
        });

        model.addEventListener('mousemove', (event) => {
          if (isDragging) {
            const deltaX = event.clientX - previousMousePosition.x;
            const deltaY = event.clientY - previousMousePosition.y;

            const rotation = model.getAttribute('rotation');
            model.setAttribute('rotation', {
              x: rotation.x + deltaY * 0.1,
              y: rotation.y + deltaX * 0.1,
              z: rotation.z
            });

            previousMousePosition = { x: event.clientX, y: event.clientY };
          }
        });
      });
    </script> 
  </body> 
</html>
